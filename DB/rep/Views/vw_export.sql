
    CREATE   VIEW [rep].[vw_export] AS
    /*
    View is generated by  : metro
    Generated at          : 2025-01-06 16:02:25
    Description           : View on stage table
    */
    SELECT 
        -- List of columns:
        LTRIM(RTRIM(CAST([bk] as varchar(255)))) as [bk], LTRIM(RTRIM(CAST([code] as varchar(255)))) as [code], LTRIM(RTRIM(CAST([name] as varchar(255)))) as [name], LTRIM(RTRIM(CAST([Description] as varchar(255)))) as [Description], LTRIM(RTRIM(CAST([active] as varchar(255)))) as [active], LTRIM(RTRIM(CAST([bk_dataset] as varchar(255)))) as [bk_dataset], LTRIM(RTRIM(CAST([bk_schema] as varchar(255)))) as [bk_schema], LTRIM(RTRIM(CAST([container] as varchar(255)))) as [container], LTRIM(RTRIM(CAST([folder] as varchar(255)))) as [folder], LTRIM(RTRIM(CAST([filename] as varchar(255)))) as [filename], LTRIM(RTRIM(CAST([datetime] as varchar(255)))) as [datetime], LTRIM(RTRIM(CAST([bk_fileformat] as varchar(255)))) as [bk_fileformat], LTRIM(RTRIM(CAST([where_filter] as varchar(255)))) as [where_filter], LTRIM(RTRIM(CAST([order_by] as varchar(255)))) as [order_by], LTRIM(RTRIM(CAST([BK_ContactGroup] as varchar(255)))) as [BK_ContactGroup], LTRIM(RTRIM(CAST([split_by] as varchar(255)))) as [split_by], LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] as varchar(255)))) as [BK_RefType_RepositoryStatus], LTRIM(RTRIM(CAST([mta_Source] as varchar(255)))) as [mta_Source], LTRIM(RTRIM(CAST([mta_LoadDate] as varchar(255)))) as [mta_LoadDate],
        -- Meta data columns:
        mta_RowNum     = ROW_NUMBER() OVER (ORDER BY [BK] ASC),
        mta_BK         = UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-')),
        mta_BKH        = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-'))), 2),
        mta_RH         = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([bk] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([code] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([name] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Description] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([active] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([bk_dataset] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([bk_schema] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([container] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([folder] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([filename] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([datetime] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([bk_fileformat] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([where_filter] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([order_by] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_ContactGroup] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([split_by] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_Source] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_LoadDate] AS VARCHAR(255)))),'-'))), 2)
    FROM [rep].[export]
    WHERE 1=1 and 1=1
      AND ISNULL(Active,'1') = '1'
      AND ISNULL(LTRIM(RTRIM([BK])),'') != ''