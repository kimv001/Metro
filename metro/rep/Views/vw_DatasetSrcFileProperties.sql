
    CREATE   VIEW [rep].[vw_DatasetSrcFileProperties] AS
    /*
    View is generated by  : metro
    Generated at          : 2025-01-06 16:02:25
    Description           : View on stage table
    */
    SELECT 
        -- List of columns:
        LTRIM(RTRIM(CAST([BK] as varchar(255)))) as [BK], LTRIM(RTRIM(CAST([Code] as varchar(255)))) as [Code], LTRIM(RTRIM(CAST([Name] as varchar(255)))) as [Name], LTRIM(RTRIM(CAST([Description] as varchar(255)))) as [Description], LTRIM(RTRIM(CAST([BK_SrcDataset] as varchar(255)))) as [BK_SrcDataset], LTRIM(RTRIM(CAST([Active] as varchar(255)))) as [Active], LTRIM(RTRIM(CAST([BK_FileFormat] as varchar(255)))) as [BK_FileFormat], LTRIM(RTRIM(CAST([FileSystem] as varchar(255)))) as [FileSystem], LTRIM(RTRIM(CAST([Folder] as varchar(255)))) as [Folder], LTRIM(RTRIM(CAST([Filename] as varchar(255)))) as [Filename], LTRIM(RTRIM(CAST([FileMask] as varchar(255)))) as [FileMask], LTRIM(RTRIM(CAST([BK_Schedule_Expected] as varchar(255)))) as [BK_Schedule_Expected], LTRIM(RTRIM(CAST([ExpectedFileSize] as varchar(255)))) as [ExpectedFileSize], LTRIM(RTRIM(CAST([ExpectedFileCount] as varchar(255)))) as [ExpectedFileCount], LTRIM(RTRIM(CAST([isPGP] as varchar(255)))) as [isPGP], LTRIM(RTRIM(CAST([DateInFileNameStartPos] as varchar(255)))) as [DateInFileNameStartPos], LTRIM(RTRIM(CAST([DateinFileNameLength] as varchar(255)))) as [DateinFileNameLength], LTRIM(RTRIM(CAST([DateInFileNameFormat] as varchar(255)))) as [DateInFileNameFormat], LTRIM(RTRIM(CAST([DateInFileNameExpression] as varchar(max)))) as [DateInFileNameExpression], LTRIM(RTRIM(CAST([TestDateInFileName] as varchar(255)))) as [TestDateInFileName], LTRIM(RTRIM(CAST([IsSystem] as varchar(255)))) as [IsSystem], LTRIM(RTRIM(CAST([Filesize] as varchar(255)))) as [Filesize], LTRIM(RTRIM(CAST([Threshold] as varchar(255)))) as [Threshold], LTRIM(RTRIM(CAST([mta_Source] as varchar(255)))) as [mta_Source], LTRIM(RTRIM(CAST([mta_LoadDate] as varchar(255)))) as [mta_LoadDate],
        -- Meta data columns:
        mta_RowNum     = ROW_NUMBER() OVER (ORDER BY [BK] ASC),
        mta_BK         = UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-')),
        mta_BKH        = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-'))), 2),
        mta_RH         = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Code] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Name] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Description] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_SrcDataset] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Active] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_FileFormat] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([FileSystem] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Folder] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Filename] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([FileMask] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Schedule_Expected] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ExpectedFileSize] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ExpectedFileCount] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([isPGP] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DateInFileNameStartPos] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DateinFileNameLength] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DateInFileNameFormat] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DateInFileNameExpression] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([TestDateInFileName] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([IsSystem] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Filesize] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Threshold] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_Source] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_LoadDate] AS VARCHAR(255)))),'-'))), 2)
    FROM [rep].[DatasetSrcFileProperties]
    WHERE 1=1 and 1=1
      AND ISNULL(Active,'1') = '1'
      AND ISNULL(LTRIM(RTRIM([BK])),'') != ''