
    CREATE   VIEW [rep].[vw_Schedules] AS
    /*
    View is generated by  : metro
    Generated at          : 2025-01-06 16:02:26
    Description           : View on stage table
    */
    SELECT 
        -- List of columns:
        LTRIM(RTRIM(CAST([BK] as varchar(255)))) as [BK], LTRIM(RTRIM(CAST([Code] as varchar(255)))) as [Code], LTRIM(RTRIM(CAST([ProcessSourceDependencies] as varchar(255)))) as [ProcessSourceDependencies], LTRIM(RTRIM(CAST([Name] as varchar(255)))) as [Name], LTRIM(RTRIM(CAST([Description] as varchar(255)))) as [Description], LTRIM(RTRIM(CAST([Active] as varchar(255)))) as [Active], LTRIM(RTRIM(CAST([BK_Schedule] as varchar(255)))) as [BK_Schedule], LTRIM(RTRIM(CAST([ProcessAll] as varchar(255)))) as [ProcessAll], LTRIM(RTRIM(CAST([ExcludeFromAllLevel] as varchar(255)))) as [ExcludeFromAllLevel], LTRIM(RTRIM(CAST([ExcludeFromAllOther] as varchar(255)))) as [ExcludeFromAllOther], LTRIM(RTRIM(CAST([dependend_on_schedules_group] as varchar(255)))) as [dependend_on_schedules_group], LTRIM(RTRIM(CAST([schedules_group] as varchar(255)))) as [schedules_group], LTRIM(RTRIM(CAST([BK_SRCDataset] as varchar(255)))) as [BK_SRCDataset], LTRIM(RTRIM(CAST([SRC_Shortname] as varchar(255)))) as [SRC_Shortname], LTRIM(RTRIM(CAST([BK_TrnDataset] as varchar(255)))) as [BK_TrnDataset], LTRIM(RTRIM(CAST([BK_Group] as varchar(255)))) as [BK_Group], LTRIM(RTRIM(CAST([BK_Schema] as varchar(255)))) as [BK_Schema], LTRIM(RTRIM(CAST([BK_Layer] as varchar(255)))) as [BK_Layer], LTRIM(RTRIM(CAST([BK_SRC_layer] as varchar(255)))) as [BK_SRC_layer], LTRIM(RTRIM(CAST([BK_export] as varchar(255)))) as [BK_export], LTRIM(RTRIM(CAST([IsSystem] as varchar(255)))) as [IsSystem], LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] as varchar(255)))) as [BK_RefType_RepositoryStatus], LTRIM(RTRIM(CAST([mta_Source] as varchar(255)))) as [mta_Source], LTRIM(RTRIM(CAST([mta_LoadDate] as varchar(255)))) as [mta_LoadDate],
        -- Meta data columns:
        mta_RowNum     = ROW_NUMBER() OVER (ORDER BY [BK] ASC),
        mta_BK         = UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-')),
        mta_BKH        = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-'))), 2),
        mta_RH         = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Code] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ProcessSourceDependencies] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Name] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Description] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Active] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Schedule] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ProcessAll] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ExcludeFromAllLevel] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ExcludeFromAllOther] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([dependend_on_schedules_group] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([schedules_group] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_SRCDataset] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([SRC_Shortname] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_TrnDataset] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Group] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Schema] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Layer] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_SRC_layer] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_export] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([IsSystem] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_Source] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_LoadDate] AS VARCHAR(255)))),'-'))), 2)
    FROM [rep].[Schedules]
    WHERE 1=1 and 1=1
      AND ISNULL(Active,'1') = '1'
      AND ISNULL(LTRIM(RTRIM([BK])),'') != ''