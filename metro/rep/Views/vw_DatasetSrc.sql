
CREATE VIEW [rep].[vw_datasetsrc] AS /*
    View is generated by  : metro
    Generated at          : 2025-01-06 16:02:25
    Description           : View on stage table
    */
SELECT -- List of columns:
 ltrim(rtrim(cast([bk] AS varchar(255)))) AS [bk],

       ltrim(rtrim(cast([code] AS varchar(255)))) AS [code],

       ltrim(rtrim(cast([name] AS varchar(255)))) AS [name],

       ltrim(rtrim(cast([schema] AS varchar(255)))) AS [schema],

       ltrim(rtrim(cast([datasource] AS varchar(255)))) AS [datasource],

       ltrim(rtrim(cast([prefix] AS varchar(255)))) AS [prefix],

       ltrim(rtrim(cast([active] AS varchar(255)))) AS [active],

       ltrim(rtrim(cast([description] AS varchar(255)))) AS [description],

       ltrim(rtrim(cast([bk_contactgroup_data_logistics] AS varchar(255)))) AS [bk_contactgroup_data_logistics],

       ltrim(rtrim(cast([data_logistics_info] AS varchar(255)))) AS [data_logistics_info],

       ltrim(rtrim(cast([bk_contactgroup_data_supplier] AS varchar(255)))) AS [bk_contactgroup_data_supplier],

       ltrim(rtrim(cast([data_supplier_info] AS varchar(255)))) AS [data_supplier_info],

       ltrim(rtrim(cast([bk_contactgroup] AS varchar(255)))) AS [bk_contactgroup],

       ltrim(rtrim(cast([bk_schema] AS varchar(255)))) AS [bk_schema],

       ltrim(rtrim(cast([bk_group] AS varchar(255)))) AS [bk_group],

       ltrim(rtrim(cast([shortname] AS varchar(255)))) AS [shortname],

       ltrim(rtrim(cast([suffix] AS varchar(255)))) AS [suffix],

       ltrim(rtrim(cast([dwhtargetshortname] AS varchar(255)))) AS [dwhtargetshortname],

       ltrim(rtrim(cast([bk_flow] AS varchar(255)))) AS [bk_flow],

       ltrim(rtrim(cast([timestamp] AS varchar(255)))) AS [timestamp],

       ltrim(rtrim(cast([businessdate] AS varchar(MAX)))) AS [businessdate],

       ltrim(rtrim(cast([recordsrcdate] AS varchar(MAX)))) AS [recordsrcdate],

       ltrim(rtrim(cast([distinctvalues] AS varchar(255)))) AS [distinctvalues],

       ltrim(rtrim(cast([wherefilter] AS varchar(255)))) AS [wherefilter],

       ltrim(rtrim(cast([partitionstatement] AS varchar(255)))) AS [partitionstatement],

       ltrim(rtrim(cast([bk_reftype_objecttype] AS varchar(255)))) AS [bk_reftype_objecttype],

       ltrim(rtrim(cast([fullload] AS varchar(255)))) AS [fullload],

       ltrim(rtrim(cast([insertonly] AS varchar(255)))) AS [insertonly],

       ltrim(rtrim(cast([insertnocheck] AS varchar(255)))) AS [insertnocheck],

       ltrim(rtrim(cast([bigdata] AS varchar(255)))) AS [bigdata],

       ltrim(rtrim(cast([bk_template_load] AS varchar(255)))) AS [bk_template_load],

       ltrim(rtrim(cast([bk_template_create] AS varchar(255)))) AS [bk_template_create],

       ltrim(rtrim(cast([customstagingview] AS varchar(255)))) AS [customstagingview],

       ltrim(rtrim(cast([bk_reftype_repositorystatus] AS varchar(255)))) AS [bk_reftype_repositorystatus],

       ltrim(rtrim(cast([issystem] AS varchar(255)))) AS [issystem],

       ltrim(rtrim(cast([mta_source] AS varchar(255)))) AS [mta_source],

       ltrim(rtrim(cast([mta_loaddate] AS varchar(255)))) AS [mta_loaddate], -- Meta data columns:
 mta_rownum = row_number() OVER (
                                 ORDER BY [bk] ASC),

       mta_bk = upper(isnull(ltrim(rtrim(cast([bk] AS varchar(500)))), '-')),

       mta_bkh = convert(char(64), hashbytes('SHA2_512', upper(isnull(ltrim(rtrim(cast([bk] AS varchar(500)))), '-'))), 2),

       mta_rh = convert(char(64), hashbytes('SHA2_512', upper(isnull(ltrim(rtrim(cast([bk] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([code] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([name] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([schema] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([datasource] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([prefix] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([active] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([description] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_contactgroup_data_logistics] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([data_logistics_info] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_contactgroup_data_supplier] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([data_supplier_info] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_contactgroup] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_schema] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_group] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([shortname] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([suffix] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([dwhtargetshortname] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_flow] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([timestamp] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([businessdate] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([recordsrcdate] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([distinctvalues] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([wherefilter] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([partitionstatement] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_reftype_objecttype] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([fullload] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([insertonly] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([insertnocheck] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bigdata] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_template_load] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_template_create] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([customstagingview] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([bk_reftype_repositorystatus] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([issystem] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([mta_source] AS varchar(255)))), '-') + '|' + isnull(ltrim(rtrim(cast([mta_loaddate] AS varchar(255)))), '-'))), 2)

  FROM [rep].[datasetsrc]

 WHERE 1 = 1

   AND 1 = 1

   AND isnull(active, '1') = '1'

   AND isnull(ltrim(rtrim([bk])), '') != ''
