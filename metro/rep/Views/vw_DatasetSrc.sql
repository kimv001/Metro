
    CREATE   VIEW [rep].[vw_DatasetSrc] AS
    /*
    View is generated by  : metro
    Generated at          : 2025-01-06 16:02:25
    Description           : View on stage table
    */
    SELECT 
        -- List of columns:
        LTRIM(RTRIM(CAST([BK] as varchar(255)))) as [BK], LTRIM(RTRIM(CAST([Code] as varchar(255)))) as [Code], LTRIM(RTRIM(CAST([Name] as varchar(255)))) as [Name], LTRIM(RTRIM(CAST([Schema] as varchar(255)))) as [Schema], LTRIM(RTRIM(CAST([DataSource] as varchar(255)))) as [DataSource], LTRIM(RTRIM(CAST([Prefix] as varchar(255)))) as [Prefix], LTRIM(RTRIM(CAST([Active] as varchar(255)))) as [Active], LTRIM(RTRIM(CAST([Description] as varchar(255)))) as [Description], LTRIM(RTRIM(CAST([bk_ContactGroup_Data_Logistics] as varchar(255)))) as [bk_ContactGroup_Data_Logistics], LTRIM(RTRIM(CAST([Data_Logistics_Info] as varchar(255)))) as [Data_Logistics_Info], LTRIM(RTRIM(CAST([bk_ContactGroup_Data_Supplier] as varchar(255)))) as [bk_ContactGroup_Data_Supplier], LTRIM(RTRIM(CAST([Data_Supplier_Info] as varchar(255)))) as [Data_Supplier_Info], LTRIM(RTRIM(CAST([BK_ContactGroup] as varchar(255)))) as [BK_ContactGroup], LTRIM(RTRIM(CAST([BK_Schema] as varchar(255)))) as [BK_Schema], LTRIM(RTRIM(CAST([BK_Group] as varchar(255)))) as [BK_Group], LTRIM(RTRIM(CAST([ShortName] as varchar(255)))) as [ShortName], LTRIM(RTRIM(CAST([Suffix] as varchar(255)))) as [Suffix], LTRIM(RTRIM(CAST([dwhTargetShortName] as varchar(255)))) as [dwhTargetShortName], LTRIM(RTRIM(CAST([BK_Flow] as varchar(255)))) as [BK_Flow], LTRIM(RTRIM(CAST([TimeStamp] as varchar(255)))) as [TimeStamp], LTRIM(RTRIM(CAST([BusinessDate] as varchar(max)))) as [BusinessDate], LTRIM(RTRIM(CAST([RecordSrcDate] as varchar(max)))) as [RecordSrcDate], LTRIM(RTRIM(CAST([DistinctValues] as varchar(255)))) as [DistinctValues], LTRIM(RTRIM(CAST([WhereFilter] as varchar(255)))) as [WhereFilter], LTRIM(RTRIM(CAST([PartitionStatement] as varchar(255)))) as [PartitionStatement], LTRIM(RTRIM(CAST([BK_RefType_ObjectType] as varchar(255)))) as [BK_RefType_ObjectType], LTRIM(RTRIM(CAST([FullLoad] as varchar(255)))) as [FullLoad], LTRIM(RTRIM(CAST([InsertOnly] as varchar(255)))) as [InsertOnly], LTRIM(RTRIM(CAST([InsertNoCheck] as varchar(255)))) as [InsertNoCheck], LTRIM(RTRIM(CAST([BigData] as varchar(255)))) as [BigData], LTRIM(RTRIM(CAST([BK_Template_Load] as varchar(255)))) as [BK_Template_Load], LTRIM(RTRIM(CAST([BK_Template_Create] as varchar(255)))) as [BK_Template_Create], LTRIM(RTRIM(CAST([CustomStagingView] as varchar(255)))) as [CustomStagingView], LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] as varchar(255)))) as [BK_RefType_RepositoryStatus], LTRIM(RTRIM(CAST([IsSystem] as varchar(255)))) as [IsSystem], LTRIM(RTRIM(CAST([mta_Source] as varchar(255)))) as [mta_Source], LTRIM(RTRIM(CAST([mta_LoadDate] as varchar(255)))) as [mta_LoadDate],
        -- Meta data columns:
        mta_RowNum     = ROW_NUMBER() OVER (ORDER BY [BK] ASC),
        mta_BK         = UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-')),
        mta_BKH        = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(500)))),'-'))), 2),
        mta_RH         = CONVERT(CHAR(64), HASHBYTES('SHA2_512', UPPER(ISNULL(LTRIM(RTRIM(CAST([BK] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Code] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Name] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Schema] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DataSource] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Prefix] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Active] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Description] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([bk_ContactGroup_Data_Logistics] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Data_Logistics_Info] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([bk_ContactGroup_Data_Supplier] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Data_Supplier_Info] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_ContactGroup] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Schema] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Group] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([ShortName] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([Suffix] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([dwhTargetShortName] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Flow] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([TimeStamp] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BusinessDate] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([RecordSrcDate] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([DistinctValues] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([WhereFilter] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([PartitionStatement] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_RefType_ObjectType] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([FullLoad] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([InsertOnly] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([InsertNoCheck] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BigData] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Template_Load] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_Template_Create] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([CustomStagingView] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([BK_RefType_RepositoryStatus] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([IsSystem] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_Source] AS VARCHAR(255)))),'-') + '|' + ISNULL(LTRIM(RTRIM(CAST([mta_LoadDate] AS VARCHAR(255)))),'-'))), 2)
    FROM [rep].[DatasetSrc]
    WHERE 1=1 and 1=1
      AND ISNULL(Active,'1') = '1'
      AND ISNULL(LTRIM(RTRIM([BK])),'') != ''