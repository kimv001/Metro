
        CREATE   VIEW [bld].[vw_RefType] AS
        /*
        View is generated by  : metro
        Generated at          : 2024-12-24 08:25:26
        Description           : View on stage table
        */
        WITH Cur AS (
            SELECT 
                [RefTypeId] AS [RefTypeId],
                [BK] AS [BK],
                [Code] AS [Code],
                [Name] AS [Name],
                [Description] AS [Description],
                [RefType] AS [RefType],
                [RefTypeAbbr] AS [RefTypeAbbr],
                [SortOrder] AS [SortOrder],
                [LinkedReftype] AS [LinkedReftype],
                [BK_LinkedRefType] AS [BK_LinkedRefType],
                [LinkedRefTypeCode] AS [LinkedRefTypeCode],
                [LinkedRefTypeName] AS [LinkedRefTypeName],
                [LinkedRefTypeDecription] AS [LinkedRefTypeDecription],
                [DefaultValue] AS [DefaultValue],
                [isDefault] AS [isDefault],
                [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
                [mta_CurrentFlag] = ROW_NUMBER() OVER (PARTITION BY [mta_BKH] ORDER BY [mta_CreateDate] DESC)
            FROM [bld].[RefType]
               
        )
        SELECT 
            [RefTypeId] AS [RefTypeId],
            [BK] AS [BK],
            [Code] AS [Code],
            [Name] AS [Name],
            [Description] AS [Description],
            [RefType] AS [RefType],
            [RefTypeAbbr] AS [RefTypeAbbr],
            [SortOrder] AS [SortOrder],
            [LinkedReftype] AS [LinkedReftype],
            [BK_LinkedRefType] AS [BK_LinkedRefType],
            [LinkedRefTypeCode] AS [LinkedRefTypeCode],
            [LinkedRefTypeName] AS [LinkedRefTypeName],
            [LinkedRefTypeDecription] AS [LinkedRefTypeDecription],
            [DefaultValue] AS [DefaultValue],
            [isDefault] AS [isDefault],
            [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
            [mta_IsDeleted] = IIF([mta_RecType] = -1, 1, 0)
        FROM Cur
        WHERE [mta_CurrentFlag] = 1 AND [mta_RecType] > -1