
        CREATE   VIEW [bld].[vw_Flow] AS
        /*
        View is generated by  : metro
        Generated at          : 2024-12-24 08:25:26
        Description           : View on stage table
        */
        WITH Cur AS (
            SELECT 
                [FlowId] AS [FlowId],
                [BK] AS [BK],
                [Code] AS [Code],
                [BK_Flow] AS [BK_Flow],
                [Flow_Name] AS [Flow_Name],
                [Flow_Description] AS [Flow_Description],
                [Flow_Layer_Step_Name] AS [Flow_Layer_Step_Name],
                [Flow_Layer_Step_Description] AS [Flow_Layer_Step_Description],
                [Flow_Layer_Step_Order] AS [Flow_Layer_Step_Order],
                [BK_Layer] AS [BK_Layer],
                [BK_Schema] AS [BK_Schema],
                [ReadFromView] AS [ReadFromView],
                [BK_Template_Load] AS [BK_Template_Load],
                [BK_Template_Create] AS [BK_Template_Create],
                [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
                [mta_CurrentFlag] = ROW_NUMBER() OVER (PARTITION BY [mta_BKH] ORDER BY [mta_CreateDate] DESC)
            FROM [bld].[Flow]
               
        )
        SELECT 
            [FlowId] AS [FlowId],
            [BK] AS [BK],
            [Code] AS [Code],
            [BK_Flow] AS [BK_Flow],
            [Flow_Name] AS [Flow_Name],
            [Flow_Description] AS [Flow_Description],
            [Flow_Layer_Step_Name] AS [Flow_Layer_Step_Name],
            [Flow_Layer_Step_Description] AS [Flow_Layer_Step_Description],
            [Flow_Layer_Step_Order] AS [Flow_Layer_Step_Order],
            [BK_Layer] AS [BK_Layer],
            [BK_Schema] AS [BK_Schema],
            [ReadFromView] AS [ReadFromView],
            [BK_Template_Load] AS [BK_Template_Load],
            [BK_Template_Create] AS [BK_Template_Create],
            [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
            [mta_IsDeleted] = IIF([mta_RecType] = -1, 1, 0)
        FROM Cur
        WHERE [mta_CurrentFlag] = 1 AND [mta_RecType] > -1