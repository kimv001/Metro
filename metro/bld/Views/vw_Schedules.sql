
        CREATE   VIEW [bld].[vw_Schedules] AS
        /*
        View is generated by  : metro
        Generated at          : 2025-01-21 08:32:49
        Description           : View on stage table
        */
        WITH Cur AS (
            SELECT 
                [SchedulesId] AS [SchedulesId],
                [BK] AS [BK],
                [schedules_group] AS [schedules_group],
                [dependend_on_schedules_group] AS [dependend_on_schedules_group],
                [Code] AS [Code],
                [BK_Schedule] AS [BK_Schedule],
                [TargetToLoad] AS [TargetToLoad],
                [ScheduleType] AS [ScheduleType],
                [ExcludeFromAllLevel] AS [ExcludeFromAllLevel],
                [ExcludeFromAllOther] AS [ExcludeFromAllOther],
                [ProcessSourceDependencies] AS [ProcessSourceDependencies],
                [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
                [mta_CurrentFlag] = ROW_NUMBER() OVER (PARTITION BY [mta_BKH] ORDER BY [mta_CreateDate] DESC)
            FROM [bld].[Schedules]
               
        )
        SELECT 
            [SchedulesId] AS [SchedulesId],
            [BK] AS [BK],
            [schedules_group] AS [schedules_group],
            [dependend_on_schedules_group] AS [dependend_on_schedules_group],
            [Code] AS [Code],
            [BK_Schedule] AS [BK_Schedule],
            [TargetToLoad] AS [TargetToLoad],
            [ScheduleType] AS [ScheduleType],
            [ExcludeFromAllLevel] AS [ExcludeFromAllLevel],
            [ExcludeFromAllOther] AS [ExcludeFromAllOther],
            [ProcessSourceDependencies] AS [ProcessSourceDependencies],
            [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
            [mta_IsDeleted] = IIF([mta_RecType] = -1, 1, 0)
        FROM Cur
        WHERE [mta_CurrentFlag] = 1 AND [mta_RecType] > -1