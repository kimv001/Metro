
        CREATE   VIEW [bld].[vw_Template] AS
        /*
        View is generated by  : metro
        Generated at          : 2024-12-24 08:25:26
        Description           : View on stage table
        */
        WITH Cur AS (
            SELECT 
                [TemplateId] AS [TemplateId], [BK] AS [BK], [Code] AS [Code], [TemplateName] AS [TemplateName], [TemplateType] AS [TemplateType], [TemplateDecription] AS [TemplateDecription], [ObjectType] AS [ObjectType], [ObjectTypeDeployOrder] AS [ObjectTypeDeployOrder], [Script] AS [Script], [ScriptLanguageCode] AS [ScriptLanguageCode], [ScriptLanguage] AS [ScriptLanguage], [ObjectName] AS [ObjectName], [BK_RefType_TemplateType] AS [BK_RefType_TemplateType], [BK_RefType_ObjectType] AS [BK_RefType_ObjectType], [BK_RefType_ObjectType_BasedOn] AS [BK_RefType_ObjectType_BasedOn], [BK_RefType_ScriptLanguage] AS [BK_RefType_ScriptLanguage], [TemplateVersion] AS [TemplateVersion],
                [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
                [mta_CurrentFlag] = ROW_NUMBER() OVER (PARTITION BY [mta_BKH] ORDER BY [mta_CreateDate] DESC)
            FROM [bld].[Template]
               
        )
        SELECT 
            [TemplateId] AS [TemplateId], [BK] AS [BK], [Code] AS [Code], [TemplateName] AS [TemplateName], [TemplateType] AS [TemplateType], [TemplateDecription] AS [TemplateDecription], [ObjectType] AS [ObjectType], [ObjectTypeDeployOrder] AS [ObjectTypeDeployOrder], [Script] AS [Script], [ScriptLanguageCode] AS [ScriptLanguageCode], [ScriptLanguage] AS [ScriptLanguage], [ObjectName] AS [ObjectName], [BK_RefType_TemplateType] AS [BK_RefType_TemplateType], [BK_RefType_ObjectType] AS [BK_RefType_ObjectType], [BK_RefType_ObjectType_BasedOn] AS [BK_RefType_ObjectType_BasedOn], [BK_RefType_ScriptLanguage] AS [BK_RefType_ScriptLanguage], [TemplateVersion] AS [TemplateVersion],
            [mta_RecType], [mta_CreateDate], [mta_Source], [mta_BK], [mta_BKH], [mta_RH],
            [mta_IsDeleted] = IIF([mta_RecType] = -1, 1, 0)
        FROM Cur
        WHERE [mta_CurrentFlag] = 1 AND [mta_RecType] > -1